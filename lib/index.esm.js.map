{"version":3,"file":"index.esm.js","sources":["../src/helpers/deep-assign.ts","../src/helpers/reducer-logger.ts","../src/context.tsx"],"sourcesContent":["import { Context } from '../context';\n\nexport function deepAssign(target: Context, ...sources: Context[]): Context {\n  for (const source of sources) {\n    for (const key in source) {\n      const s = source[key];\n      if (Object(s) === s) {\n        const t = target[key];\n        if (Object(t) === t) {\n          target[key] = Object.create(deepAssign(t, s));\n          continue;\n        }\n        target[key] = Object.create(deepAssign({}, s));\n        continue;\n      }\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\n","import { Action, Context, Reducer } from '../context';\n\nexport const reducerLogger = (reducer: Reducer, description: string = 'context'): Reducer => {\n  return (state: Context, action: Action) => {\n    const log: any = {};\n    log.actions = JSON.parse(JSON.stringify(action));\n    log.before = JSON.parse(JSON.stringify(state));\n    const after = reducer(state, action);\n    log.after = JSON.parse(JSON.stringify(after));\n    console.log(description, log);\n    return after;\n  };\n};\n","import React, { createContext, useContext, useReducer } from 'react';\nimport { deepAssign } from './helpers';\n\nexport * from './helpers';\n\nexport interface Context {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: Context | any;\n}\n\nexport interface Action extends Context {\n  type: string;\n}\n\nexport type Dispatch = React.Dispatch<Action>;\nexport type Reducer = React.Reducer<Context, Action>;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type Selector<C = Context> = (state: Context) => C | any;\n\nexport interface ContextProps {\n  state: Context;\n  dispatch: Dispatch;\n}\n\nexport interface StoreProps {}\n\nconst rootSelector: Selector = (state) => state;\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nfunction createStore(reducer: Reducer, initialState: Context) {\n  const Context = createContext<ContextProps>({\n    state: {},\n    dispatch: () => {}, // eslint-disable-line @typescript-eslint/no-empty-function\n  });\n\n  const Store: React.FC<StoreProps> = ({ children }) => {\n    const [state, dispatch] = useReducer(reducer, deepAssign({} ,initialState));\n\n    return (\n      <Context.Provider value={{ state, dispatch }}>\n        {children}\n      </Context.Provider>\n    );\n  };\n\n  function useStore<C = Context>(\n    selector: Selector<C> = rootSelector\n  ): [C, Dispatch] {\n    const { state, dispatch } = useContext(Context);\n    return [selector(state), dispatch];\n  }\n\n  function useDispatch(): Dispatch {\n    const { dispatch } = useContext(Context);\n    return dispatch;\n  }\n\n  function useState<C = Context>(\n    selector: Selector<C> = rootSelector\n  ): C {\n    const { state } = useContext(Context);\n    return selector(state);\n  }\n\n  return { Store, useStore, useDispatch, useState };\n}\n\nexport { createStore };\n"],"names":[],"mappings":"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"}